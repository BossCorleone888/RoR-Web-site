import{s as G,g as p,w as W,h as b,o as J,i as r,j as e,F as H,k as S,l as g,n as O,q as B,t as U,v as j,x as M,y as v,z as Q,A as V,B as d,C as Y,D as Z,E as ee}from"./vendor-D1zEduYY.js";import{M as te}from"./markdown-Z74jomBb.js";import"./firebase-CLZxBhh6.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))f(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function w(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function f(s){if(s.ep)return;s.ep=!0;const a=w(s);fetch(s.href,a)}})();console.warn("[firebase] config missing. App runs WITHOUT Firebase (UIは表示されるよ)");const se=G,ne={class:"layout-pc"},oe={class:"sidenav"},ae={class:"sidenav-inner"},le={"aria-label":"サイドナビ"},ie={class:"nav-list"},re=["onClick","aria-current"],de={class:"nav-text"},ce={class:"content"},ue={class:"panel"},pe=["innerHTML"],ve={key:1,class:"loading"},fe={class:"sidebar"},me={class:"pad"},be={key:0,class:"card",style:{"border-color":"#f8cdcd",background:"#fff5f5"}},he=["aria-disabled"],_e=["disabled"],ge=["disabled"],ye={class:"hint"},we={class:"row"},xe=["disabled"],Ce=["disabled"],ke={class:"card list"},Le={class:"posts"},Oe={class:"meta"},Me={class:"name"},Te={class:"time"},Fe=["onClick"],Ae=["textContent"],Ee={key:0,class:"empty"},P=500,R=10,Ie={__name:"App",setup(i){const o=new te({breaks:!0}),w=Object.assign({}),f=p([]),s=p(null),a=p("");async function m(){const l=[];for(const[t,n]of Object.entries(w)){const _=await n(),L=_?.default??_;if(typeof L!="string")continue;const K=(L.split(/\r?\n/).find(X=>X.trim())||"").replace(/^#\s*/,""),D=t.split("/").pop().replace(/\.md$/,"");l.push({id:D,title:K||D,raw:L})}l.sort((t,n)=>t.id.localeCompare(n.id,"ja")),f.value=l,!s.value&&l.length&&(s.value=l[0].id)}W(s,()=>{const l=f.value.find(t=>t.id===s.value);a.value=l?o.render(l.raw):""});const x=p(""),c=p(""),T=p([]),C=p(null),u=p(!1);let h=null;const F=b(()=>c.value.length),A=b(()=>c.value?c.value.split(/\r\n|\r|\n/).length:0),E=b(()=>F.value>P),I=b(()=>A.value>R),N=b(()=>!!c.value.trim()&&!E.value&&!I.value);J(async()=>{await m(),console.warn("[App] Firebase 未設定：投稿UIは表示されるけど無効だべさ")});function k(){if(!u.value||!h)return alert("Firebase未設定（.env.local を作ってビルドすると投稿できるべさ）"),!0}function z(){if(k())return;const l=c.value.trim(),t=x.value.trim()||"名無し";N.value&&Y(h,{name:t,text:l,created_at:se(),uid:C.value?.uid??null}).then(()=>{c.value=""}).catch(n=>{console.error("[addDoc] error",n)})}async function $(l){if(!k())try{await V(Z(h.firestore,"messages",l))}catch(t){console.error("[delete] error",t),alert("削除に失敗したかも。")}}async function q(){if(k()||!confirm("全投稿を削除しますか？"))return;const l=await Q(h);for(const t of l.docs)await V(t.ref)}return(l,t)=>(d(),r("div",ne,[e("aside",oe,[e("div",ae,[t[3]||(t[3]=e("div",{class:"logo"},"MENU",-1)),e("nav",le,[e("ul",ie,[(d(!0),r(H,null,S(f.value,n=>(d(),r("li",{key:n.id},[e("a",{href:"#",class:M(["nav-link",{active:n.id===s.value}]),onClick:B(_=>s.value=n.id,["prevent"]),"aria-current":n.id===s.value?"page":void 0},[t[2]||(t[2]=e("span",{class:"dot","aria-hidden":"true"},null,-1)),e("span",de,v(n.title),1)],10,re)]))),128))])])])]),e("main",ce,[t[4]||(t[4]=e("h2",{class:"title"},"♠♡♦♧ RoRメンバーサイト ♠♡♦♧",-1)),t[5]||(t[5]=e("p",{class:"lead"},[g("ここではメンバー向けに "),e("strong",null,"ルール"),g(" や "),e("strong",null,"ノウハウ"),g(" を共有します。")],-1)),e("section",ue,[a.value?(d(),r("article",{key:0,class:"md",innerHTML:a.value},null,8,pe)):(d(),r("div",ve,"読み込み中…（content フォルダに .md を置くと自動で出るべ）"))])]),e("aside",fe,[e("div",me,[t[11]||(t[11]=e("h3",null,"✍️ メンバー書き込み",-1)),u.value?O("",!0):(d(),r("div",be,[...t[6]||(t[6]=[e("strong",{style:{color:"#b20000"}},"Firebase未設定",-1),e("br",null,null,-1),g(" `.env.local` を作ってビルドすると投稿できるべさ（下に手順書いた）。 ",-1)])])),e("form",{onSubmit:B(z,["prevent"]),class:"card","aria-disabled":!u.value},[t[8]||(t[8]=e("label",{class:"lbl"},"ニックネーム",-1)),U(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>x.value=n),class:"input",placeholder:"例：Momo56 / 名無し など",disabled:!u.value},null,8,_e),[[j,x.value]]),t[9]||(t[9]=e("label",{class:"lbl"},"メッセージ",-1)),U(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=n=>c.value=n),class:"textarea",placeholder:"複数行OK。ノウハウや連絡事項などをどうぞ",rows:"5",disabled:!u.value},null,8,ge),[[j,c.value]]),e("div",ye,[e("span",{class:M({over:E.value})},v(F.value)+"/"+v(P)+"文字",3),t[7]||(t[7]=e("span",null,"・",-1)),e("span",{class:M({over:I.value})},v(A.value)+"/"+v(R)+"行",3)]),e("div",we,[e("button",{class:"btn-primary",type:"submit",disabled:!N.value||!u.value},"投稿",8,xe),e("button",{class:"btn-danger",type:"button",onClick:q,disabled:!u.value},"全削除",8,Ce)])],40,he),e("div",ke,[t[10]||(t[10]=e("h4",null,"🗂 最新の投稿",-1)),e("ul",Le,[(d(!0),r(H,null,S(T.value,n=>(d(),r("li",{key:n.id,class:"post"},[e("div",Oe,[e("strong",Me,v(n.name||"名無し"),1),e("small",Te,v(n.at),1),u.value&&n.uid&&C.value&&n.uid===C.value.uid?(d(),r("button",{key:0,class:"btn-mini",type:"button",onClick:_=>$(n.id)}," 削除 ",8,Fe)):O("",!0)]),e("div",{class:"text",textContent:v(n.text)},null,8,Ae)]))),128)),T.value.length===0?(d(),r("li",Ee,"まだ投稿はありません。")):O("",!0)])]),t[12]||(t[12]=e("p",{class:"note"},"※ Firestoreでリアルタイム共有しています。",-1))])])]))}};(function(){const o=document.createElement("div");o.style.cssText="position:fixed;z-index:99999;left:0;top:0;right:0;background:#111;color:#0f0;font:12px/1.4 monospace;padding:6px 8px",o.textContent="BOOTING... location="+location.href,document.addEventListener("DOMContentLoaded",()=>document.body.appendChild(o))})();function y(i){const o=document.createElement("pre");o.style.cssText="white-space:pre-wrap;padding:16px;background:#fff;color:#c00;border:1px solid #f99;font-family:monospace",o.textContent=`起動時エラー:
`+(i?.stack||i),document.body.innerHTML="",document.body.appendChild(o)}try{const i=ee(Ie);i.config.errorHandler=o=>y(o),window.addEventListener("error",o=>y(o.error||o.message)),window.addEventListener("unhandledrejection",o=>y(o.reason)),i.mount("#app")}catch(i){y(i)}
//# sourceMappingURL=index-BW8hZ1wM.js.map

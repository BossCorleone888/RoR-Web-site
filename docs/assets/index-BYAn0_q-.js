import{r as E,o as x,w as Y,c as b,a as _,b as h,d as e,F as M,e as N,f as k,g as D,h as T,v as R,n as I,t as g,i as Z,j as G}from"./vue-DgBOhy0X.js";import{M as J}from"./markdown-BMSQkwth.js";import{i as ee,g as te,a as se,s as ne,o as oe,b as ae,c as re,q as le,d as ie,e as ce,f as de,h as V,j as ue,k as me}from"./firebase-C2Mfe1vl.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&p(r)}).observe(document,{childList:!0,subtree:!0});function y(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function p(s){if(s.ep)return;s.ep=!0;const a=y(s);fetch(s.href,a)}})();const pe="modulepreload",ve=function(w){return"/RoR-Web-site/"+w},j={},A=function(d,y,p){let s=Promise.resolve();if(y&&y.length>0){let u=function(l){return Promise.all(l.map(v=>Promise.resolve(v).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=r?.nonce||r?.getAttribute("nonce");s=u(y.map(l=>{if(l=ve(l),l in j)return;j[l]=!0;const v=l.endsWith(".css"),f=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const c=document.createElement("link");if(c.rel=v?"stylesheet":pe,v||(c.as="script"),c.crossOrigin="",c.href=l,i&&c.setAttribute("nonce",i),document.head.appendChild(c),v)return new Promise((C,L)=>{c.addEventListener("load",C),c.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return s.then(r=>{for(const i of r||[])i.status==="rejected"&&a(i.reason);return d().catch(a)})},fe={apiKey:"AIzaSyCsOqpk7qzesQfNhIVb_Nm-lSAtWoNg2Z0",authDomain:"ror-web-site.firebaseapp.com",projectId:"ror-web-site",appId:"1:777517324792:web:5fe680dc85e91239d71e0d"},F=ee(fe),q=te(F),_e=ae,P=se(F);async function he(){return P.currentUser||await ne(P),new Promise(w=>oe(P,d=>d&&w(d)))}const ge={class:"layout-pc"},ye={class:"sidenav"},be={class:"sidenav-inner"},we={"aria-label":"サイドナビ"},Ee={class:"nav-list"},Ce=["onClick","aria-current"],Le={class:"nav-text"},Se={class:"content"},Ae={class:"panel"},Oe=["innerHTML"],ke={key:1,class:"loading"},Ie={class:"sidebar"},Pe={class:"pad"},xe={class:"hint"},Me={class:"row"},Ne=["disabled"],De={class:"card list"},Te={class:"posts"},Re={class:"meta"},Ve={class:"name"},je={class:"time"},qe=["onClick"],Ue=["textContent"],$e={key:0,class:"empty"},U="ror_selected_topic_v2",$=500,B=10,Be={__name:"App",setup(w){const d=new J({breaks:!0}),y=Object.assign({"./content/1.基本.md":()=>A(()=>import("./1.基本-BllvYrDA.js"),[]).then(o=>o.default),"./content/2.players.md":()=>A(()=>import("./2.players-IYwVCbU4.js"),[]).then(o=>o.default),"./content/3.略語集.md":()=>A(()=>import("./3.略語集-MdPddEiQ.js"),[]).then(o=>o.default),"./content/4.リンク.md":()=>A(()=>import("./4.リンク-Bb9p9_Ht.js"),[]).then(o=>o.default)}),p=E([]),s=E("");x(async()=>{const o=Object.entries(y).sort((n,m)=>n[0].localeCompare(m[0],"ja"));for(const[n,m]of o){const S=await m();let W=(S.split(/\r?\n/).find(Q=>Q.trim().length)??"Untitled").replace(/^#+\s*/,"").trim();const X=n.split("/").pop().replace(/\.md$/,"");p.value.push({id:X,title:W,body:S})}const t=localStorage.getItem(U);s.value=t&&p.value.some(n=>n.id===t)?t:p.value[0]?.id||""}),Y(s,o=>{o&&localStorage.setItem(U,o)});const a=b(()=>p.value.find(o=>o.id===s.value)),r=b(()=>a.value?d.render(a.value.body):""),i=E(""),u=E(""),l=E([]),v=b(()=>u.value.length),f=b(()=>u.value?u.value.split(/\r\n|\r|\n/).length:0),c=b(()=>v.value>$),C=b(()=>f.value>B),L=b(()=>!!u.value.trim()&&!c.value&&!C.value),O=re(q,"messages");x(async()=>{await he();const o=le(O,ie("created_at","desc"));ce(o,t=>{l.value=t.docs.map(n=>{const m=n.data(),S=m.created_at?.toDate?m.created_at.toDate():new Date;return{id:n.id,name:m.name||"名無し",text:m.text||"",at:S.toLocaleString()}})})});function z(){const o=u.value.trim(),t=i.value.trim()||"名無し";L.value&&ue(O,{name:t,text:o,created_at:_e()}).then(()=>{u.value=""})}async function H(o){await V(me(q,"messages",o))}async function K(){if(!confirm("全投稿を削除しますか？"))return;const o=await de(O);for(const t of o.docs)await V(t.ref)}return(o,t)=>(h(),_("div",ge,[e("aside",ye,[e("div",be,[t[3]||(t[3]=e("div",{class:"logo"},"MENU",-1)),e("nav",we,[e("ul",Ee,[(h(!0),_(M,null,N(p.value,n=>(h(),_("li",{key:n.id},[e("a",{href:"#",class:I(["nav-link",{active:n.id===s.value}]),onClick:D(m=>s.value=n.id,["prevent"]),"aria-current":n.id===s.value?"page":void 0},[t[2]||(t[2]=e("span",{class:"dot","aria-hidden":"true"},null,-1)),e("span",Le,g(n.title),1)],10,Ce)]))),128))])])])]),e("main",Se,[t[4]||(t[4]=e("h2",{class:"title"},"♠♡♦♧ RoRメンバーサイト ♠♡♦♧",-1)),t[5]||(t[5]=e("p",{class:"lead"},[k("ここではメンバー向けに "),e("strong",null,"ルール"),k(" や "),e("strong",null,"ノウハウ"),k(" を共有します。")],-1)),e("section",Ae,[r.value?(h(),_("article",{key:0,class:"md",innerHTML:r.value},null,8,Oe)):(h(),_("div",ke,"読み込み中…（content フォルダに .md を置くと自動で出るべ）"))])]),e("aside",Ie,[e("div",Pe,[t[10]||(t[10]=e("h3",null,"✍️ メンバー書き込み",-1)),e("form",{onSubmit:D(z,["prevent"]),class:"card"},[t[7]||(t[7]=e("label",{class:"lbl"},"ニックネーム",-1)),T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),class:"input",placeholder:"例：Momo56 / 名無し など"},null,512),[[R,i.value]]),t[8]||(t[8]=e("label",{class:"lbl"},"メッセージ",-1)),T(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=n=>u.value=n),class:"textarea",placeholder:"複数行OK。ノウハウや連絡事項などをどうぞ",rows:"5"},null,512),[[R,u.value]]),e("div",xe,[e("span",{class:I({over:c.value})},g(v.value)+"/"+g($)+"文字",3),t[6]||(t[6]=e("span",null,"・",-1)),e("span",{class:I({over:C.value})},g(f.value)+"/"+g(B)+"行",3)]),e("div",Me,[e("button",{class:"btn-primary",type:"submit",disabled:!L.value},"投稿",8,Ne),e("button",{class:"btn-danger",type:"button",onClick:K},"全削除")])],32),e("div",De,[t[9]||(t[9]=e("h4",null,"🗂 最新の投稿",-1)),e("ul",Te,[(h(!0),_(M,null,N(l.value,n=>(h(),_("li",{key:n.id,class:"post"},[e("div",Re,[e("strong",Ve,g(n.name||"名無し"),1),e("small",je,g(n.at),1),e("button",{class:"btn-mini",type:"button",onClick:m=>H(n.id)},"削除",8,qe)]),e("div",{class:"text",textContent:g(n.text)},null,8,Ue)]))),128)),l.value.length===0?(h(),_("li",$e,"まだ投稿はありません。")):Z("",!0)])]),t[11]||(t[11]=e("p",{class:"note"},"※ Firestoreでリアルタイム共有しています。",-1))])])]))}};G(Be).mount("#app");

import{s as G,g as h,w as J,h as w,o as Q,i as f,j as e,F as N,k as R,l as L,n as A,q as F,t as U,v as V,x as M,y as b,z as Y,A as j,B as _,C as Z,D as ee,E as te}from"./vendor-D1zEduYY.js";import{M as se}from"./markdown-Z74jomBb.js";import"./firebase-CLZxBhh6.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))g(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&g(c)}).observe(document,{childList:!0,subtree:!0});function y(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function g(s){if(s.ep)return;s.ep=!0;const r=y(s);fetch(s.href,r)}})();const ne="modulepreload",oe=function(i){return"/RoR-Web-site/"+i},B={},k=function(o,y,g){let s=Promise.resolve();if(y&&y.length>0){let v=function(u){return Promise.all(u.map(m=>Promise.resolve(m).then(l=>({status:"fulfilled",value:l}),l=>({status:"rejected",reason:l}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");s=v(y.map(u=>{if(u=oe(u),u in B)return;B[u]=!0;const m=u.endsWith(".css"),l=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${l}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":ne,m||(p.as="script"),p.crossOrigin="",p.href=u,d&&p.setAttribute("nonce",d),document.head.appendChild(p),m)return new Promise((E,x)=>{p.addEventListener("load",E),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return s.then(c=>{for(const d of c||[])d.status==="rejected"&&r(d.reason);return o().catch(r)})};console.warn("[firebase] config missing. App runs WITHOUT Firebase (UIは表示されるよ)");const re=G,ae={class:"layout-pc"},le={class:"sidenav"},ie={class:"sidenav-inner"},ce={"aria-label":"サイドナビ"},de={class:"nav-list"},ue=["onClick","aria-current"],pe={class:"nav-text"},ve={class:"content"},me={class:"panel"},fe=["innerHTML"],_e={key:1,class:"loading"},he={class:"sidebar"},be={class:"pad"},ye={key:0,class:"card",style:{"border-color":"#f8cdcd",background:"#fff5f5"}},ge=["aria-disabled"],we=["disabled"],Ee=["disabled"],xe={class:"hint"},Ce={class:"row"},Le=["disabled"],ke=["disabled"],Oe={class:"card list"},Te={class:"posts"},Ae={class:"meta"},Me={class:"name"},Pe={class:"time"},Ie=["onClick"],Se=["textContent"],De={key:0,class:"empty"},H=500,$=10,Ne={__name:"App",setup(i){const o=new se({breaks:!0}),y=Object.assign({"./content/1.基本.md":()=>k(()=>import("./1.基本-BllvYrDA.js"),[]),"./content/2.players.md":()=>k(()=>import("./2.players-IYwVCbU4.js"),[]),"./content/3.略語集.md":()=>k(()=>import("./3.略語集-MdPddEiQ.js"),[]),"./content/4.リンク.md":()=>k(()=>import("./4.リンク-Bb9p9_Ht.js"),[])}),g=h([]),s=h(null),r=h("");async function c(){const a=[];for(const[t,n]of Object.entries(y)){const C=await n(),K=(C.split(/\r?\n/).find(X=>X.trim())||"").replace(/^#\s*/,""),D=t.split("/").pop().replace(/\.md$/,"");a.push({id:D,title:K||D,raw:C})}a.sort((t,n)=>t.id.localeCompare(n.id,"ja")),g.value=a,!s.value&&a.length&&(s.value=a[0].id)}J(s,()=>{const a=g.value.find(t=>t.id===s.value);r.value=a?o.render(a.raw):""});const d=h(""),v=h(""),u=h([]),m=h(null),l=h(!1);let p=null;const E=w(()=>v.value.length),x=w(()=>v.value?v.value.split(/\r\n|\r|\n/).length:0),P=w(()=>E.value>H),I=w(()=>x.value>$),S=w(()=>!!v.value.trim()&&!P.value&&!I.value);Q(async()=>{await c(),console.warn("[App] Firebase 未設定：投稿UIは表示されるけど無効だべさ")});function T(){if(!l.value||!p)return alert("Firebase未設定（.env.local を作ってビルドすると投稿できるべさ）"),!0}function q(){if(T())return;const a=v.value.trim(),t=d.value.trim()||"名無し";S.value&&Z(p,{name:t,text:a,created_at:re(),uid:m.value?.uid??null}).then(()=>{v.value=""}).catch(n=>{console.error("[addDoc] error",n)})}async function z(a){if(!T())try{await j(ee(p.firestore,"messages",a))}catch(t){console.error("[delete] error",t),alert("削除に失敗したかも。")}}async function W(){if(T()||!confirm("全投稿を削除しますか？"))return;const a=await Y(p);for(const t of a.docs)await j(t.ref)}return(a,t)=>(_(),f("div",ae,[e("aside",le,[e("div",ie,[t[3]||(t[3]=e("div",{class:"logo"},"MENU",-1)),e("nav",ce,[e("ul",de,[(_(!0),f(N,null,R(g.value,n=>(_(),f("li",{key:n.id},[e("a",{href:"#",class:M(["nav-link",{active:n.id===s.value}]),onClick:F(C=>s.value=n.id,["prevent"]),"aria-current":n.id===s.value?"page":void 0},[t[2]||(t[2]=e("span",{class:"dot","aria-hidden":"true"},null,-1)),e("span",pe,b(n.title),1)],10,ue)]))),128))])])])]),e("main",ve,[t[4]||(t[4]=e("h2",{class:"title"},"♠♡♦♧ RoRメンバーサイト ♠♡♦♧",-1)),t[5]||(t[5]=e("p",{class:"lead"},[L("ここではメンバー向けに "),e("strong",null,"ルール"),L(" や "),e("strong",null,"ノウハウ"),L(" を共有します。")],-1)),e("section",me,[r.value?(_(),f("article",{key:0,class:"md",innerHTML:r.value},null,8,fe)):(_(),f("div",_e,"読み込み中…（content フォルダに .md を置くと自動で出るべ）"))])]),e("aside",he,[e("div",be,[t[11]||(t[11]=e("h3",null,"✍️ メンバー書き込み",-1)),l.value?A("",!0):(_(),f("div",ye,[...t[6]||(t[6]=[e("strong",{style:{color:"#b20000"}},"Firebase未設定",-1),e("br",null,null,-1),L(" `.env.local` を作ってビルドすると投稿できるべさ（下に手順書いた）。 ",-1)])])),e("form",{onSubmit:F(q,["prevent"]),class:"card","aria-disabled":!l.value},[t[8]||(t[8]=e("label",{class:"lbl"},"ニックネーム",-1)),U(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>d.value=n),class:"input",placeholder:"例：Momo56 / 名無し など",disabled:!l.value},null,8,we),[[V,d.value]]),t[9]||(t[9]=e("label",{class:"lbl"},"メッセージ",-1)),U(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=n=>v.value=n),class:"textarea",placeholder:"複数行OK。ノウハウや連絡事項などをどうぞ",rows:"5",disabled:!l.value},null,8,Ee),[[V,v.value]]),e("div",xe,[e("span",{class:M({over:P.value})},b(E.value)+"/"+b(H)+"文字",3),t[7]||(t[7]=e("span",null,"・",-1)),e("span",{class:M({over:I.value})},b(x.value)+"/"+b($)+"行",3)]),e("div",Ce,[e("button",{class:"btn-primary",type:"submit",disabled:!S.value||!l.value},"投稿",8,Le),e("button",{class:"btn-danger",type:"button",onClick:W,disabled:!l.value},"全削除",8,ke)])],40,ge),e("div",Oe,[t[10]||(t[10]=e("h4",null,"🗂 最新の投稿",-1)),e("ul",Te,[(_(!0),f(N,null,R(u.value,n=>(_(),f("li",{key:n.id,class:"post"},[e("div",Ae,[e("strong",Me,b(n.name||"名無し"),1),e("small",Pe,b(n.at),1),l.value&&n.uid&&m.value&&n.uid===m.value.uid?(_(),f("button",{key:0,class:"btn-mini",type:"button",onClick:C=>z(n.id)}," 削除 ",8,Ie)):A("",!0)]),e("div",{class:"text",textContent:b(n.text)},null,8,Se)]))),128)),u.value.length===0?(_(),f("li",De,"まだ投稿はありません。")):A("",!0)])]),t[12]||(t[12]=e("p",{class:"note"},"※ Firestoreでリアルタイム共有しています。",-1))])])]))}};(function(){const o=document.createElement("div");o.style.cssText="position:fixed;z-index:99999;left:0;top:0;right:0;background:#111;color:#0f0;font:12px/1.4 monospace;padding:6px 8px",o.textContent="BOOTING... location="+location.href,document.addEventListener("DOMContentLoaded",()=>document.body.appendChild(o))})();function O(i){const o=document.createElement("pre");o.style.cssText="white-space:pre-wrap;padding:16px;background:#fff;color:#c00;border:1px solid #f99;font-family:monospace",o.textContent=`起動時エラー:
`+(i?.stack||i),document.body.innerHTML="",document.body.appendChild(o)}try{const i=te(Ne);i.config.errorHandler=o=>O(o),window.addEventListener("error",o=>O(o.error||o.message)),window.addEventListener("unhandledrejection",o=>O(o.reason)),i.mount("#app")}catch(i){O(i)}
//# sourceMappingURL=index-Df3Dw5M-.js.map

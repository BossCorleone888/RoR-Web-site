import{r as E,o as M,w as Z,c as b,a as f,b as _,d as e,F as N,e as D,f as k,g as x,h as T,v as R,n as I,t as g,i as U,j as G}from"./vue-DgBOhy0X.js";import{M as J}from"./markdown-BMSQkwth.js";import{i as ee,g as te,a as se,s as ne,o as oe,b as ae,c as re,q as le,d as ie,e as ce,f as de,h as V,j as ue,k as pe}from"./firebase-C2Mfe1vl.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))m(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&m(r)}).observe(document,{childList:!0,subtree:!0});function y(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function m(n){if(n.ep)return;n.ep=!0;const a=y(n);fetch(n.href,a)}})();const me="modulepreload",ve=function(w){return"/RoR-Web-site/"+w},j={},A=function(d,y,m){let n=Promise.resolve();if(y&&y.length>0){let u=function(l){return Promise.all(l.map(v=>Promise.resolve(v).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=r?.nonce||r?.getAttribute("nonce");n=u(y.map(l=>{if(l=ve(l),l in j)return;j[l]=!0;const v=l.endsWith(".css"),h=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const c=document.createElement("link");if(c.rel=v?"stylesheet":me,v||(c.as="script"),c.crossOrigin="",c.href=l,i&&c.setAttribute("nonce",i),document.head.appendChild(c),v)return new Promise((C,L)=>{c.addEventListener("load",C),c.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return n.then(r=>{for(const i of r||[])i.status==="rejected"&&a(i.reason);return d().catch(a)})},fe={apiKey:"AIzaSyCsOqpk7qzesQfNhIVb_Nm-lSAtWoNg2Z0",authDomain:"ror-web-site.firebaseapp.com",projectId:"ror-web-site",appId:"1:777517324792:web:5fe680dc85e91239d71e0d"},z=ee(fe),q=te(z),_e=ae,P=se(z);async function he(){return P.currentUser||await ne(P),new Promise(w=>oe(P,d=>d&&w(d)))}const ge={class:"layout-pc"},ye={class:"sidenav"},be={class:"sidenav-inner"},we={"aria-label":"サイドナビ"},Ee={class:"nav-list"},Ce=["onClick","aria-current"],Le={class:"nav-text"},Se={class:"content"},Ae={class:"panel"},Oe=["innerHTML"],ke={key:1,class:"loading"},Ie={class:"sidebar"},Pe={class:"pad"},Me={class:"hint"},Ne={class:"row"},De=["disabled"],xe={class:"card list"},Te={class:"posts"},Re={class:"meta"},Ue={class:"name"},Ve={class:"time"},je=["onClick"],qe=["textContent"],$e={key:0,class:"empty"},$="ror_selected_topic_v2",B=500,F=10,Be={__name:"App",setup(w){const d=new J({breaks:!0}),y=Object.assign({"./content/1.基本.md":()=>A(()=>import("./1.基本-BllvYrDA.js"),[]).then(o=>o.default),"./content/2.players.md":()=>A(()=>import("./2.players-IYwVCbU4.js"),[]).then(o=>o.default),"./content/3.略語集.md":()=>A(()=>import("./3.略語集-MdPddEiQ.js"),[]).then(o=>o.default),"./content/4.リンク.md":()=>A(()=>import("./4.リンク-Bb9p9_Ht.js"),[]).then(o=>o.default)}),m=E([]),n=E("");M(async()=>{const o=Object.entries(y).sort((s,p)=>s[0].localeCompare(p[0],"ja"));for(const[s,p]of o){const S=await p();let X=(S.split(/\r?\n/).find(Y=>Y.trim().length)??"Untitled").replace(/^#+\s*/,"").trim();const Q=s.split("/").pop().replace(/\.md$/,"");m.value.push({id:Q,title:X,body:S})}const t=localStorage.getItem($);n.value=t&&m.value.some(s=>s.id===t)?t:m.value[0]?.id||""}),Z(n,o=>{o&&localStorage.setItem($,o)});const a=b(()=>m.value.find(o=>o.id===n.value)),r=b(()=>a.value?d.render(a.value.body):""),i=E(""),u=E(""),l=E([]),v=b(()=>u.value.length),h=b(()=>u.value?u.value.split(/\r\n|\r|\n/).length:0),c=b(()=>v.value>B),C=b(()=>h.value>F),L=b(()=>!!u.value.trim()&&!c.value&&!C.value),O=re(q,"messages");M(async()=>{await he();const o=le(O,ie("created_at","desc"));ce(o,t=>{l.value=t.docs.map(s=>{const p=s.data(),S=p.created_at?.toDate?p.created_at.toDate():new Date;return{id:s.id,name:p.name||"名無し",text:p.text||"",at:S.toLocaleString()}})})});function H(){const o=u.value.trim(),t=i.value.trim()||"名無し";L.value&&ue(O,{name:t,text:o,created_at:_e()}).then(()=>{u.value=""})}async function K(o){await V(pe(q,"messages",o))}async function W(){if(!confirm("全投稿を削除しますか？"))return;const o=await de(O);for(const t of o.docs)await V(t.ref)}return(o,t)=>(_(),f("div",ge,[e("aside",ye,[e("div",be,[t[3]||(t[3]=e("div",{class:"logo"},"MENU",-1)),e("nav",we,[e("ul",Ee,[(_(!0),f(N,null,D(m.value,s=>(_(),f("li",{key:s.id},[e("a",{href:"#",class:I(["nav-link",{active:s.id===n.value}]),onClick:x(p=>n.value=s.id,["prevent"]),"aria-current":s.id===n.value?"page":void 0},[t[2]||(t[2]=e("span",{class:"dot","aria-hidden":"true"},null,-1)),e("span",Le,g(s.title),1)],10,Ce)]))),128))])])])]),e("main",Se,[t[4]||(t[4]=e("h2",{class:"title"},"♠♡♦♧ RoRメンバーサイト ♠♡♦♧",-1)),t[5]||(t[5]=e("p",{class:"lead"},[k("ここではメンバー向けに "),e("strong",null,"ルール"),k(" や "),e("strong",null,"ノウハウ"),k(" を共有します。")],-1)),e("section",Ae,[r.value?(_(),f("article",{key:0,class:"md",innerHTML:r.value},null,8,Oe)):(_(),f("div",ke,"読み込み中…（content フォルダに .md を置くと自動で出るべ）"))])]),e("aside",Ie,[e("div",Pe,[t[10]||(t[10]=e("h3",null,"✍️ メンバー書き込み",-1)),e("form",{onSubmit:x(H,["prevent"]),class:"card"},[t[7]||(t[7]=e("label",{class:"lbl"},"ニックネーム",-1)),T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),class:"input",placeholder:"例：Momo56 / 名無し など"},null,512),[[R,i.value]]),t[8]||(t[8]=e("label",{class:"lbl"},"メッセージ",-1)),T(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.value=s),class:"textarea",placeholder:"複数行OK。ノウハウや連絡事項などをどうぞ",rows:"5"},null,512),[[R,u.value]]),e("div",Me,[e("span",{class:I({over:c.value})},g(v.value)+"/"+g(B)+"文字",3),t[6]||(t[6]=e("span",null,"・",-1)),e("span",{class:I({over:C.value})},g(h.value)+"/"+g(F)+"行",3)]),e("div",Ne,[e("button",{class:"btn-primary",type:"submit",disabled:!L.value},"投稿",8,De),e("button",{class:"btn-danger",type:"button",onClick:W},"全削除")])],32),e("div",xe,[t[9]||(t[9]=e("h4",null,"🗂 最新の投稿",-1)),e("ul",Te,[(_(!0),f(N,null,D(l.value,s=>(_(),f("li",{key:s.id,class:"post"},[e("div",Re,[e("strong",Ue,g(s.name||"名無し"),1),e("small",Ve,g(s.at),1),s.uid&&o.auth.currentUser&&s.uid===o.auth.currentUser.uid?(_(),f("button",{key:0,class:"btn-mini",type:"button",onClick:p=>K(s.id)},"削除",8,je)):U("",!0)]),e("div",{class:"text",textContent:g(s.text)},null,8,qe)]))),128)),l.value.length===0?(_(),f("li",$e,"まだ投稿はありません。")):U("",!0)])]),t[11]||(t[11]=e("p",{class:"note"},"※ Firestoreでリアルタイム共有しています。",-1))])])]))}};G(Be).mount("#app");

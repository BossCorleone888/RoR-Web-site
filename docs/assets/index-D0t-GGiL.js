import{g as R,h as T,i as D,j as k,k as N,s as P,l as q,n as B,o as U,q as S,t as y,w as F,v as _,x as V,y as $,z as H,A as z,B as K,C as W}from"./vendor-CGyoh539.js";import{M as X}from"./markdown-BdO_TpYS.js";import"./firebase-BlrTpy7P.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))p(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&p(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function p(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const G="modulepreload",J=function(t){return"/RoR-Web-site/"+t},C={},E=function(e,s,p){let n=Promise.resolve();if(s&&s.length>0){let L=function(i){return Promise.all(i.map(d=>Promise.resolve(d).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),r=a?.nonce||a?.getAttribute("nonce");n=L(s.map(i=>{if(i=J(i),i in C)return;C[i]=!0;const d=i.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${m}`))return;const c=document.createElement("link");if(c.rel=d?"stylesheet":G,d||(c.as="script"),c.crossOrigin="",c.href=i,r&&c.setAttribute("nonce",r),document.head.appendChild(c),d)return new Promise((O,v)=>{c.addEventListener("load",O),c.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${i}`)))})}))}function o(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return n.then(a=>{for(const r of a||[])r.status==="rejected"&&o(r.reason);return e().catch(o)})},Q={apiKey:void 0,authDomain:void 0,projectId:void 0,appId:void 0},Y={},I={...Y,...Object.fromEntries(Object.entries(Q).filter(([,t])=>t))},x=Object.entries(I).filter(([,t])=>!t).map(([t])=>t);if(x.length){const t=`[firebaseConfig] missing keys: ${x.join(", ")}`;console.error(t)}const j=R().length?T():D(I),Z=k(j),u=N(j);async function ee(t=1500){return u.currentUser!==null||await new Promise(e=>{const s=S(u,()=>{s(),e()});setTimeout(()=>{try{s()}catch{}e()},t)}),u.currentUser}async function te(){try{await P(u,q)}catch{try{await P(u,B)}catch(s){console.error("[auth] setPersistence failed",s?.code||s)}}const t=await ee();if(t)return t;if(typeof navigator<"u"&&navigator.onLine===!1)return console.warn("[auth] offline, skip signInAnonymously"),null;try{return(await U(u)).user}catch(e){return e?.code==="auth/network-request-failed"?(console.warn("[auth] network-request-failed, continue without auth"),null):(console.error("[auth] anonymous sign-in failed",e?.code,e?.message||e),null)}}const ne=500,oe=10,re={__name:"App",setup(t){const e=new X({breaks:!0}),s=Object.assign({"./content/1.基本.md":()=>E(()=>import("./1.基本-BllvYrDA.js"),[]),"./content/2.players.md":()=>E(()=>import("./2.players-IYwVCbU4.js"),[]),"./content/3.略語集.md":()=>E(()=>import("./3.略語集-MdPddEiQ.js"),[]),"./content/4.リンク.md":()=>E(()=>import("./4.リンク-Bb9p9_Ht.js"),[])}),p=y([]),n=y(null),o=y("");async function a(){const l=[];for(const[h,f]of Object.entries(s)){const w=await f(),g=(w.split(/\r?\n/).find(M=>M.trim())||"").replace(/^#\s*/,""),A=h.split("/").pop().replace(/\.md$/,"");l.push({id:A,title:g||A,raw:w})}l.sort((h,f)=>h.id.localeCompare(f.id,"ja")),p.value=l,!n.value&&l.length&&(n.value=l[0].id)}F(n,()=>{const l=p.value.find(h=>h.id===n.value);o.value=l?e.render(l.raw):""}),y("");const r=y(""),L=y([]),i=_(()=>r.value.length),d=_(()=>r.value?r.value.split(/\r\n|\r|\n/).length:0),m=_(()=>i.value>ne),c=_(()=>d.value>oe);_(()=>!!r.value.trim()&&!m.value&&!c.value);const O=V(Z,"messages"),v=y(null);return $(async()=>{console.log("[mounted] start"),await a();const l=await te();v.value=l,console.log("[ensureAnonLogin] uid =",v.value?.uid),S(u,f=>{v.value=f,console.log("[onAuthStateChanged] uid =",f?.uid)}),window._auth=u,window._me=v,window._topics=p;const h=H(O,z("created_at","desc"));K(h,f=>{L.value=f.docs.map(w=>{const g=w.data(),A=g.created_at?.toDate?g.created_at.toDate():new Date;return{id:w.id,name:g.name||"名無し",text:g.text||"",at:A.toLocaleString(),uid:g.uid??null}}),console.log("[onSnapshot] first=",L.value[0])}),console.log("[mounted] done")}),()=>{}}};(function(){const e=document.createElement("div");e.style.cssText="position:fixed;z-index:99999;left:0;top:0;right:0;background:#111;color:#0f0;font:12px/1.4 monospace;padding:6px 8px",e.textContent="BOOTING... location="+location.href,document.addEventListener("DOMContentLoaded",()=>document.body.appendChild(e))})();function b(t){const e=document.createElement("pre");e.style.cssText="white-space:pre-wrap;padding:16px;background:#fff;color:#c00;border:1px solid #f99;font-family:monospace",e.textContent=`起動時エラー:
`+(t?.stack||t),document.body.innerHTML="",document.body.appendChild(e)}try{const t=W(re);t.config.errorHandler=e=>b(e),window.addEventListener("error",e=>b(e.error||e.message)),window.addEventListener("unhandledrejection",e=>b(e.reason)),t.mount("#app")}catch(t){b(t)}
//# sourceMappingURL=index-D0t-GGiL.js.map
